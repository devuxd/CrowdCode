<div ng-controller="ReviewController" >

	
    <div class="section section-description " >
        <div class="section-content no-padding" >
            <ul class="microtask-details clearfix">
                <li class="bg-color">{{::datas.title}}</li>
                <li >
                    <span>{{::datas.submitValue}} points</span>
                </li>
                <li class="color">
                    <div class="help-btn" ng-click="startTutorial('WriteTestCases');"><span class="glyphicon glyphicon-question-sign"></span></div>
                </li>
            </ul>
        </div>
    </div>

	<!--///////////////////////////////////////////-->
	<!--//        WRITE TEST CASES MICROTASK     //-->
	<!--///////////////////////////////////////////-->

	<!-- prompt type = FUNCTION_SIGNATURE -->
	<div ng-if="review.microtask.type == 'WriteTestCases'"> 
		<div class="section section-description">
			<div class="section-title" >
				<div class="dot bg-color"></div>Job description
			</div>
			<div class="section-content" ng-if="review.microtask.submission.isFunctionDispute" >
				The worker was asked to write testcases but he disputed the function. <br /> Can you rate this work?
			</div>

			<div class="section-content" ng-if="review.microtask.promptType == 'FUNCTION_SIGNATURE' && !review.microtask.submission.isFunctionDispute" >
				The worker was asked to write testcases for the following function. <br /> Can you rate this work?
			</div>
			<div class="section-content" ng-if="review.microtask.promptType == 'CORRECT_TEST_CASE'&& !review.microtask.submission.isFunctionDispute" >
				The worker was asked to rewrite the test case
				<div class="form-group">
					<input type="text"
					class="form-control"
					disabled="true"
					name="disputedTestCase"
					ng-model="review.microtask.disputedTestCase"
					>
				</div>
				<br>
				that the crowd put in dispute for the following reason:<br>
				<div class="form-group has-error">
					<textarea type="text"
					class="form-control resize:none"
					disabled="true"
					name="disputedTestCase"
					ng-model="review.microtask.disputeDescription"
					></textarea>
				</div>
				<br>
				Can you review this work?
			</div>
	
		</div>
		<div class="section section-description">
			<div class="section-title" >
				<div class="dot bg-color"></div>function description
			</div>
			<div class="section-content no-padding" >
				<ace-read-js code="review.functionCode"></ace-read-js>
			</div>
		</div>
		<div class="section section-description-2" ng-if="review.microtask.submission.isFunctionDispute">
			<div class="section-title" ><div class="dot bg-color"></div>dispute reaseon</div>
			<div class="section-content" >
				<div class="form-grou has-error">
					<textarea type="text"
					class="form-control resize:none"
					disabled="true"
					name="disputedTestCase"
					ng-model="review.microtask.submission.disputeText"
					></textarea>
				</div>
			</div>
		</div>
		
		<div class="section section-description-2" ng-if="!review.microtask.submission.isFunctionDispute">
			<div class="section-title" ><div class="dot bg-color"></div>submitted test cases</div>
			<div class="section-content" >
				<ul style="list-style:none">
					<li class="" ng-repeat="testcase in review.testcases"><strong>#{{$index+1}}</strong> {{testcase.text}}</li>
				</ul>
			</div>
		</div>
	</div>

	<!--//////////////////////////////////////////-->
	<!--//           WRITE TEST MICROTASK       //-->
	<!--//////////////////////////////////////////-->
	<div ng-if="review.microtask.type == 'WriteTest'">
		<div class="section section-description">
			<div class="section-title" >
				<div class="dot bg-color"></div>Job description
			</div>
			<div ng-if="! review.microtask.submission.inDispute && ! review.microtask.submission.isFunctionDispute" class="section-content" >
				The worker was asked to write a test for the following case:
				<div class="form-group">
					<input type="text"
					class="form-control"
					disabled="true"
					name="disputedTestCase"
					ng-model="review.microtask.owningArtifact"
					>
				</div><br/>
				for the function below. Can you rate this work?
			</div>
			<div ng-if="review.microtask.submission.isFunctionDispute" class="section-content" >
				The worker disputed the test that the crowd has written for the following function:
				<div class="form-group">
					<input type="text"
					class="form-control"
					disabled="true"
					name="disputedTestCase"
					ng-model="review.microtask.owningArtifact"
					>
				</div>
				<br/> Can you rate this dispute?
			</div>
			<div ng-if="review.microtask.submission.inDispute" class="section-content" >
				The worker disputed the function signature that the crowd has written for the following test case:
				<div class="form-group">
					<input type="text"
					class="form-control"
					disabled="true"
					name="disputedTestCase"
					ng-model="review.microtask.owningArtifact"
					>
				</div>
				<br/> Can you rate this dispute?
			</div>
		</div>
		<div class="section section-description">
			<div class="section-title" ng-if="!review.microtask.submission.isFunctionDispute">
				<div class="dot bg-color"></div>function description
			</div>
			<div class="section-title" ng-if="review.microtask.submission.isFunctionDispute">
				<div class="dot bg-color"></div>function signature disputed
			</div>
			<div class="section-content no-padding" >
				<ace-read-js code="review.functionCode"></ace-read-js>
			</div>
		</div>

		<div ng-if="! review.microtask.submission.inDispute && !review.microtask.submission.isFunctionDispute" class="section section-description-2">
			<div  class="section-title" ><div class="dot bg-color"></div>submitted TEST</div>
			<div class="section-content" >
				<table style="width:100%" class="test">
					
					<tr ng-repeat="(inputKey,input) in review.microtask.submission.simpleTestInputs track by $index">
						<td>{{functionUnderTest.paramNames[$index]}}</td>
						<td>
							<div ace-read-json ng-model="input" ></div>
						</td>
					</tr>
					<tr ng-if="functionUnderTest.returnType!=undefined">
						<td>test output</td>
						<td>
							<div ace-read-json ng-model="review.microtask.submission.simpleTestOutput" ></div>
						</td>
					</tr>
				</table>
			</div>
		</div>

		<div ng-if="review.microtask.submission.inDispute || review.microtask.submission.isFunctionDispute" class="section section-description-2">
			<div class="section-title" ><div class="dot bg-color"></div>dispute reason</div>
			<div class="section-content" >
				<div class="form-group has-error">
					<textarea type="text"
					class="form-control"
					style ="resize:none"
					style="width:100%"
					disabled="true"
					name="disputedTestCase"
					ng-model="review.microtask.submission.disputeText"
					></textarea>
				</div>
			</div>
		</div>
		</div>


	<!--//////////////////////////////////////////-->
	<!--//        WRITE FUNCTION MICROTASK      //-->
	<!--//////////////////////////////////////////-->

	<div ng-if="review.microtask.type == 'WriteFunction' && review.microtask.promptType == 'RE_EDIT'">
		<div class="section section-description">
			<div class="section-title" >
				<div class="dot bg-color"></div>Job description
			</div>
			<div class="section-content" >
				The worker was asked to edit the following function to solve this issue:
				<div class="form-group  has-error">
					<textarea type="text"
					class="resize:none"
					style="width:100%"
					class="form-control"
					disabled="true"
					name="newTestCase"
					ng-model="review.microtask.disputeText"
					></textarea>
				</div><br/>
				
				<br /> Can you rate this work?
			</div>
		</div>

		<div class="section section-description-2">
			<div class="section-title" >
				<div class="dot bg-color"></div>submitted function code
			</div>
			<div class="section-content no-padding" >
				<ace-read-js code="review.functionCode" mode="diff"></ace-read-js>
			</div>
		</div>
	</div>

	<div ng-if="review.microtask.type == 'WriteFunction' && review.microtask.promptType == 'SKETCH'">
		<div class="section section-description">
			<div class="section-title" >
				<div class="dot bg-color"></div>Job description
			</div>
			<div class="section-content" >
				The worker was asked to write some code in the following function. <br /> Can you rate this work?
			</div>
		</div>

		<div class="section section-description-2">
			<div class="section-title" >
				<div class="dot bg-color"></div>submitted function code
			</div>
			<div class="section-content no-padding" >
				<ace-read-js code="review.functionCode" mode="diff"></ace-read-js>
			</div>
		</div>
	</div>

	<div ng-if="review.microtask.type == 'WriteFunction' && review.microtask.promptType == 'DESCRIPTION_CHANGE'">
		<div class="section section-description">
			<div class="section-title" >
				<div class="dot bg-color"></div>submitted work description
			</div>
			<div class="section-content" >
				After the change of the following callee function the user was asked if necessary to change the code of the caller function <br />
				<ace-read-js code="diffCode" mode="diff"></ace-read-js>
				<br>
				Can you rate this work?

			</div>
		</div>

		<div class="section section-description-2">
			<div class="section-title" >
				<div class="dot bg-color"></div>submitted function code
			</div>
			<div class="section-content" >
				<ace-read-js code="review.functionCode" mode="diff"></ace-read-js>
			</div>
		</div>
	</div>

	<!--//////////////////////////////////////////-->
	<!--// WRITE FUNCTION DESCRIPTION MICROTASK //-->
	<!--//////////////////////////////////////////-->
	<div ng-if="review.microtask.type == 'WriteFunctionDescription'">

		<div class="section section-description">
			<div class="section-title" >
				<div class="dot bg-color"></div>Job description
			</div>
			<div class="section-content" >
				The worker was given the psudocall:
				<span class="pseudoCall">{{review.microtask.callDescription}}</span> and asked to write a description for this function. <br/>
				Can you rate this work?

			</div>
		</div>

		<div class="section section-description-2">
			<div class="section-title" >
				<div class="dot bg-color"></div>submitted function code
			</div>
			<div class="section-content" >
				<ace-read-js code="review.functionCode"></ace-read-js>
			</div>
		</div>
	</div>

	<!--//////////////////////////////////////////-->
	<!--//          WRITE CALL MICROTASK        //-->
	<!--//////////////////////////////////////////-->
	<div ng-if="review.microtask.type == 'WriteCall'">
		<div class="section section-description">
			<div class="section-title" >
				<div class="dot bg-color"></div>Job description
			</div>
			<div class="section-content" >
				The worker replaced the pseudocall:
				<span class="pseudoCall">{{review.microtask.pseudoCall}}</span>
				in the following way. Can you rate this work?
			</div>
		</div>
		
		<div class="section section-description-2">
			<div class="section-title" >
				<div class="dot bg-color"></div>Description of Pseudocall function
			</div>
			<div class="section-content" >
				<ace-read-js code="review.microtask.calleeFullDescription"></ace-read-js>
			</div>
		</div>
		<div class="section section-description-2">
			<div class="section-title" >
				<div class="dot bg-color"></div>submitted function code
			</div>
			<div class="section-content" >
				<ace-read-js code="review.functionCode" mode="diff"></ace-read-js>
			</div>
		</div>
	</div>

	<alertcontainer></alertcontainer>

	<div class="section-cols" >
		<div class="container-flex-row">
			<div class="section section-help bg-color-alpha" style="width:30%">
				<div class="section-title" >
					<div class="dot"></div>RATING SYSTEM
				</div>
				<div class="section-content" >
					<ul style="list-style:none;margin:0px;padding:0px;">
						<li><b>1 Star</b>: Work incoherent or unfocussed. <b>Work will be rejected</b></li>
						<li><b>2 Star</b>: Work unconvincing or weak. <b>Work will be rejected</b></li>
						<li><b>3 Star</b>: Work with some weakness. <b>A microtask will be created to fix this work</b></li>
						<li><b>4 Star</b>: Work with some minor issues. <b>Work will be accepted</b></li>
						<li><b>5 Star</b>: Excellent work with no significant weaknesses. <b>Work will be accepted</b></li>
					</ul>

				</div>
				<div class="section-title" >
					<div class="dot"></div>
					AVAILABLE DATA TYPES
				</div>
				<div class="section-content" >
					<adt-list></adt-list>
				</div>
			</div>

			<div class="section section-form" style="width:70%;" >

				<div class="section-content" >
					<div id="ratingsDiv" >
						<span class="pull-left"></span>
						
						<span ng-repeat="currentValue in [1,2,3,4,5] track by $index"
							  ng-mouseenter="review.mouseOn=currentValue"
							  ng-mouseleave="review.mouseOn=0"
							  ng-click="rate(currentValue)">
							<span class="rating-star {{ ( review.mouseOn > $index || review.rating > $index ) ? 'full' : '' }}"></span>
							<span ng-if="$index == 1||$index == 2" class="rating-separator" ></span>
						</span>
						
					<!--	<div class="btn-group" role="group" aria-label="...">
						  <button type="button" class="btn btn-default" ng-click="accept($event)" >Accept</button>
						  <button type="button" class="btn btn-default" ng-click="reissue($event)" >Reissue</button>
						  <button type="button" class="btn btn-default" ng-click="reject($event)" >Reject</button>
						</div>-->

						<span class="clearfix"></span>
					</div>
					<br />

					<label ng-if="review.rating != -1"> Choice </label>
					<span ng-if="review.rating == 1||review.rating == 2">Reject</span>
					<span ng-if="review.rating == 3">Revise work</span>
					<span ng-if="review.rating == 4||review.rating == 5">Accept</span>
					<br />
					<label for="reviewText" >Motivation:</label>
					<textarea
						id="reviewText" class="col-md-12 form-control input-sm" ng-model="review.reviewText" name="reviewText" ng-required="review.rating < 4" focus></textarea>
					<span
					class="help-block" ng-show="microtaskForm.reviewText.$dirty && review.rating < 4 && microtaskForm.reviewText.$invalid && microtaskForm.reviewText.$error.required">This field is required!</span>
				</div>
			</div>

		</div>
	</div>

	<!--
	<div class="task-buttons pull-right">
		<button ng-click="submit()" class="btn btn-primary" ng-disabled="form.$invalid || review.rate<1 " >Submit</button>
		<button ng-click="$emit('skipMicrotask')" class="btn btn-link">Skip</button>
	</div>
	<div class="clearfix"></div>
-->
</div>
