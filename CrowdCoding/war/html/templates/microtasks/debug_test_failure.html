
<div ng-controller="DebugTestFailureController" class="task-container container-flex-column">

	<div class="section section-description " >
		<div class="section-content no-padding" >
			<ul class="microtask-details clearfix">
				<li>{{datas.title}}</li>
				<li>
					<span>{{datas.submitValue}} points</span>
				</li>
				<li>
					<div class="help-btn"><span class="glyphicon glyphicon-question-sign"></span></div>
				</li>
			</ul>
		</div>
	</div>


	<div class="section section-description">
		<div class="section-title" >
		JOB DESCRIPTION
		</div>
		<div class="section-content" >
			One (or more) of the tests for the function <strong>{{funct.name}}</strong> had failed. Can you find and resolve the bug? 
		</div>
	</div>


	<div class="section section-description" id="functionSignature">
		<div class="section-title" >
			FUNCTION SIGNATURE
		</div>
		<div class="section-content no-padding" >
			<code-mirror-readonly code="functionDescription"></code-mirror-readonly>
		</div>
	</div>

	<alertcontainer></alertcontainer>

	<div class="section-cols" ng-if="!dispute && !testsRunning" >
		<div class="container-flex-row">

			<div class="section section-help" style="width:30%">
				<div class="section-title" >
					TESTS RESULT
				</div>
				<div class="section-content" >
				
					
					Each box shows the result of each test for the current function, if a test is passed the box has a green background otherwise the background is red.
					You can <strong> dispute </strong> the failing tests. <br /> <strong>Important:</strong> you can dispute only one test!
					
					<button ng-click="runTests()" class="btn btn-primary"  >Run the tests!</button>
				</div>
			</div>

			
			<div class="section section-form" style="width:70%;">
				<div class="section-content no-padding" >

					<collapsable-list
					    data="testsData" 
					    add-data="{ 'paramNames' : paramNames }"
					    class="test-collapsable-list"
					    list-element-class-condition="'success': data.result , 'failed': ! data.result "
						toggler-template="/html/templates/collapsable_toggler_test.html"
						element-template="/html/templates/collapsable_element_test.html">
					</collapsable-list>

				</div>
			</div>
		</div>
	</div>

	<div class="section-cols" ng-if=" !dispute ">
		<div class="container-flex-row">

			<div class="section section-help" style="width:30%">
				<div class="section-title" >
				FUNCTION EDITOR  
				</div>
				<div class="section-content" >
			 		<p>
			 			For monitoring statements, use <strong>debug.log(statement)</strong>. The results of the Debug.log() are printed below each <strong>test result</strong>.
			 		</p>
				</div>

				<div class="section-title" > AVAILABLE DATA STRUCTURES </div>
				<div class="section-content" >
						<adt-bar></adt-bar>
				</div>
			</div>

			<div class="section section-form" style="width:70%">
				<div class="section-content" >
					<div ui-codemirror="{ onLoad : codemirrorLoaded, autofocus : true }" ng-model="code" focus></div>
					<textarea function-validator class="form-control" name="code" ng-model="code" ng-show="false"></textarea>
					<ul class="help-block" ng-show="microtaskForm.code.$error.function_errors.length > 0">
						<span>There are some errors. Please fix them before submit:</span>
						<ul ng-repeat="error in microtaskForm.code.$error.function_errors track by $id($index)">
							<li>{{error}}</li>
						</ul>
					</ul>
					<ng-include src="'/html/templates/java_tutorial.html'"></ng-include>
					<span class="clearfix"></span>
				</div>
			</div>

		</div>
	</div>

	<div class="section-cols" ng-if=" !dispute && !testsRunning">
		<div class="container-flex-row">

			<div class="section section-help" style="width:30%">
				<div class="section-title" >
				CALLEE STUBS 
				</div>
				<div class="section-content" >
					<p>
						For each function called by <strong>{{funct.name}}</strong> you can choose the behavior of that
						callee will have for each different input parameters with which is called. 
						It means that the <strong>Test Runner</strong> will use the behavior you choose
						instead of running the real code.
					</p>
				</div>
			</div>

			<div class="section section-form"  style="width:70%" >
				<div class="section-title" >
				
				</div>
				<div class="section-content" >
					
					<ul style="list-style:none;margin:0px;padding:0px;">
						<li ng-repeat="(callee,inputMap) in stubs" > 
							The function <b>{{callee}}</b> has been called with {{ inputMap | keylength }}  {{ (inputMap | keylength) > 1 ? 'different sets':'set' }} of inputs
							<ul class="collapsable-list mock-collapsable-list ">
								<li ng-repeat="(stubKey,stub) in inputMap track by $index">
									<b>#{{$index+1}} input set </b><br />
									<table style="width:100%">
										<tr ng-repeat="(key,input) in stub.inputs ">
											<td>input</td>
											<td><div ace-read-json ng-model="input" ></div></td>
										</tr>
										<tr>
											<td>output</td>
											<td><div ace-edit-json ng-model="stub.output" ></div></td>
										</tr>
									</table>
								</li>
							</ul>
						</li>
					</ul>
				</div>
			</div>

		</div>
	</div>
	

	

	<div class="section section-form" ng-if="dispute">
		<div class="section-title" >
			DISPUTE TEST 
		</div>
		<div class="section-content" >
 			<span><b>Test description:</b> {{disputedTest.description}}</span><br/>
			<span><b>Test code:</b> {{disputedTest.code}}</span><br/>

			<label for="disputeDescription">What's wrong with this test? </label>
			<textarea name="disputeDescription" class="form-control" ng-model="disp.disputeText"></textarea><br>
			<button class="btn" ng-click="cancelDispute()" >Nothing is wrong with the test</button>
		</div>
	</div>
<!--
	<div class="task-buttons pull-right">
		<button ng-click="submit()" class="btn btn-primary" ng-disabled="form.$invalid || passedTests.length != tests.length" >Submit</button>
		<button ng-click="$emit('skipMicrotask')"   class="btn btn-link"   >Skip</button>
	</div>
	<div class="clearfix"></div>
-->
</div>