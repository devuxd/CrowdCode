
<div ng-controller="DebugTestFailureController" class="task-container container-flex-column">

	<div class="section section-description " >
		<div class="section-content no-padding" >
			<ul class="microtask-details clearfix">
				<li>{{datas.title}}</li>
				<li>
					<span>{{datas.submitValue}} points</span>
				</li>
				<li>
					<div class="help-btn"><span class="glyphicon glyphicon-question-sign"></span></div>
				</li>
			</ul>
		</div>
	</div>

	<div class="section section-form">
		<div class="section-title" >
		TEST CASES
		</div>
		<div class="section-content" >
			<table class="debugTests">
				<tr>
					<th>Description</th>
					<th>Test Code</th>
					<th>Result</th>
					<th></th>
				</tr>
				<tr class="{{ testPassed(key) ? 'passed' : 'failed' }}"
					ng-init="showDetails[key]=false"
					ng-repeat="(key,test) in tests"
					>
					<td class="description">{{test.description}}</td>

					<td class="">
						{{test.code}}

						<div ng-repeat="callee in callees">
							{{callee.name}}
						</div>
					</td>

					<td>
						<span ng-if="testPassed(key)">PASSED</span>
						<span ng-if="!testPassed(key)">FAILED</span>
					</td>

					<td>
						<button class="btn btn-primary" 
							ng-click="disputeTest(key)" 
							ng-hide="testPassed(key)" 
						> Dispute </button>
					</td>
				</tr>
			</table>
			<button ng-click="runTests()" class="btn btn-primary"  >Run the tests!</button>
			<br/>
		</div>
	</div>


	<div class="section section-form">
		<div class="section-title" >
		CONSOLE
		</div>
		<div class="section-content" >
			<div ng-model="consoleOutput" ui-codemirror="{ onLoad : consoleLoaded }"></div>
		</div>
	</div>

	<div class="section section-form">
		<div class="section-title" >
		FUNCTION EDITOR
		</div>
		<div class="section-content" >
			<div ui-codemirror="{ onLoad : codemirrorLoaded }"></div>
			<textarea function-validator class="form-control" name="code" ng-model="code" ng-show="false"></textarea>
			<ul class="help-block" ng-show="form.code.$error.function_errors.length > 0">
				<span>There are some errors. Please fix them before submit:</span>
				<ul ng-repeat="error in form.code.$error.function_errors track by $id($index)">
					<li>{{error}}</li>
				</ul>
			</ul>
			<ng-include src="'/html/templates/java_tutorial.html'"></ng-include>
			<span class="clearfix"></span>
		</div>
	</div>


	

	<div id="taskForm" ng-show="dispute">
		<span><b>Test description:</b> {{disputedTest.description}}</span><br/>
		<span><b>Test code:</b> {{disputedTest.code}}</span><br/>

		<label for="disputeText">Dispute test:</b> what's wrong with this test? </label>
		<textarea name="disputeText" class="form-control" ng-model="disputedTest.disputeText"></textarea><br>
		<button class="btn " ng-click="dispute = !dispute" >Nothing is wrong with the test</button>
		<button class="btn btn-primary" ng-if="dispute" ng-click="submit()" >Submit dispute</button>
	</div>


	<br/>
<!--
	<div class="task-buttons pull-right">
		<button ng-click="submit()" class="btn btn-primary" ng-disabled="form.$invalid || passedTests.length != tests.length" >Submit</button>
		<button ng-click="$emit('skipMicrotask')"   class="btn btn-link"   >Skip</button>
	</div>
	<div class="clearfix"></div>
-->
</div>