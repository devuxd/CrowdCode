<!DOCTYPE html>
<html lang="en" ng-app="clientRequest">
	<head>
		<title>CrowdCode Client Request Editor</title>
		<link rel="stylesheet" href="/include/bootstrap/css/bootstrap.min.css">
		<link rel="stylesheet" href="/css/client_request.css">
	  

	</head>
	<body ng-controller="ClientRequestController">
		<script src="/include/jquery-2.1.0.min.js"></script>
		<script src="/include/bootstrap/js/bootstrap.min.js"> </script>
		<script src="https://cdn.firebase.com/js/client/1.0.21/firebase.js"></script>
		<script src="/include/polyfill.js"></script>
		<script src="/include/jshint.js"></script>
		<script src="/js/errorCheck.js"></script>
		<script src="/js/functionSupport.js"></script>
		<script src="/js/ADTandDataCheck.js"></script>
		<!-- Javascript 3rd part libraries -->
		<script src="/include/jquery-2.1.0.min.js"></script>
		<script src="/include/polyfill.js"></script>
		<script src="/include/jshint.js"></script>
		<script src="/include/bootstrap/js/bootstrap.min.js"> </script>
		<script src="https://cdn.firebase.com/js/client/1.0.21/firebase.js"></script>
		<script src='/include/esprima.js'></script>
		<script src='/include/escodegen.browser.js'></script>
		<script src="/include/angular/angular.min.js"></script> <!-- AngularJS -->
		<script src="/include/angular/angular-animate.min.js"></script><!-- Angular animate -->
		<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular-sanitize.js"></script>
		<script src="https://cdn.firebase.com/js/client/1.0.21/firebase.js"></script> <!-- firebase -->
		<script src="https://cdn.firebase.com/libs/angularfire/0.8.2/angularfire.min.js"></script> <!-- angularfire -->
		<script src="/include/angular-strap/dist/angular-strap.min.js"></script>
		<script src="/include/angular-strap/dist/angular-strap.tpl.min.js"></script>
		<script src="/js/JSONValidator.js"></script>
		<!-- Angular Application -->
		<script src="/js/clientRequest/application.js"></script>
		<!-- Angular Controllers -->
		<script src="/js/clientRequest/controller.js"></script>
		<!-- Angular directives -->
		<script src="/js/clientRequest/directives.js"></script>
		<div ng-form="form" class="task">
			<div class="section section-description " >
				<div class="section-content no-padding" >
					<ul class="microtask-details clearfix">
						<li>Welcome to the <b>CrowdCode Client Request Editor</b></li>
					</ul>
				</div>
			</div>
			<div class="section section-description">
				<div class="section-title" >
					Project Name
				</div>
				<div class="section-content" >
					Enter a project name in the textbox below to retrieve the client request for the project.
					If it does not exist, it will be created. <BR><BR>
					
					<div ng-form="projectNameForm" class=" form-horizontal form-group col-md-12">
						<div class="col-md-3 form-group">
							<alertcontainer></alertcontainer>
							<input class="form-control input-sm" type="text" ng-model="projectName" name="projectName"
							placeholder="Project Name" required ng-pattern="/^[a-zA-Z0-9_]+$/" focus/>
							<ul class="help-block" ng-show="projectNameForm.projectName.$dirty && projectNameForm.projectName.$invalid">
								<li ng-show="projectNameForm.projectName.$error.required">This field is required!</li>
								<li ng-show="projectNameForm.projectName.$error.pattern">Is not a valid name! only use a-zA-Z0-9_</li>
							</ul>
						</div>
						<button ng-click="load()" class="col-md-1 btn btn-small " ng-disabled="projectNameForm.$invalid || !projectNameForm.projectName.$dirty">Load</button>
					</div>
					<div class="clearfix"></div>
				</div>
			</div>
			<div class="section section-description">
				<div class="section-title" >
					ADTs
				</div>
				<div class="section-content" >
					<span>
					Describe ADTs with a description, name, structure, and some example. The JSON structure should be of the form
					<b>fieldA: TypeName</b>, where each TypeName is either defined separately as an
					ADT or is one of the three primitives String, Number, Boolean. To indicate an n-dimensional array, add
					n sets of brackets after the type name (e.g., 2 dimensional array - TypeName[][]). The description should describe
					any rules about the ADT and include an example of a value of the ADT in JSON format.<BR><BR>
					</span>
					<div  ng-repeat="(ADTindex, ADT) in ADTs"   class="row">
						<div ng-form="ADTForm" class="col-sm-10 form-horizontal" role="form">
							<div class="form-group">
								<label for="description" class="col-sm-2 control-label reset-padding">description</label>
								<div class="col-sm-10 reset-padding">
									<textarea class="form-control" name="description" placeholder="briefly describe the purpose and the behavior of the ADT" ng-model="ADT.description" required ng-pattern="/^[^/\\]+$/"></textarea>
									<ul class="help-block" ng-show="ADTForm.description.$dirty && ADTForm.description.$invalid">
										<li ng-show="ADTForm.description.$error.required">This field is required!</li>
										<li ng-show="ADTForm.description.$error.pattern">The "\" and "/" are not allowed</li>
									</ul>
								</div>
							</div>
							<div class="form-group">
								<label for="ADTName" class="col-sm-2 control-label reset-padding">ADT name</label>
								<div class="col-sm-10 reset-padding">
									<input type="text" class="form-control" name="ADTName" ng-model="ADT.name" required ng-pattern="/^[a-zA-Z0-9_]+$/" function-name-validator placeholder="insert the ADT name" press-enter="addParameter()">
									<ul class="help-block" ng-show="ADTForm.ADTName.$dirty && ADTForm.ADTName.$invalid">
										<li ng-show="ADTForm.ADTName.$error.required">This field is required!</li>
										<li ng-show="ADTForm.ADTName.$error.pattern">Is not a valid function name! Please use only alphanumerical characters and the _ symbol</li>
									</ul>
								</div>
							</div>
							<div class="form-group col-sm-12">
								<label class=" control-label col-sm-2 reset-padding">JSON structure:</label>
								<div class="form-group col-sm-10 reset-padding" >
									<div ng-form="ADTStructureForm" class="form-horizontal form-container" ng-repeat="structure in ADT.structure track by $index" >
										<div class="col-sm-3 reset-padding">
											<input class="form-control pull-left" type="text" ng-model="structure.name" name="fieldName"
											placeholder="Field Name" required ng-pattern="/^[a-zA-Z0-9_]+$/"/>
											<ul class="help-block" ng-show="ADTStructureForm.fieldName.$dirty && ADTStructureForm.fieldName.$invalid">
												<li ng-show="ADTStructureForm.fieldName.$error.required">This field is required!</li>
												<li ng-show="ADTStructureForm.fieldName.$error.pattern">Is not a valid Field name! Only use a-zA-Z0-9_</li>
											</ul>
										</div>
										<div class="col-sm-3 reset-padding">
											<input class="form-control pull-left" type="text" ng-model="structure.type" name="fieldType"
											placeholder="Field Type" adt-validator required press-enter="addStructure(ADTindex)"/>
											<ul class="help-block" ng-show="ADTStructureForm.fieldType.$dirty && ADTStructureForm.fieldType.$invalid">
												<li ng-show="ADTStructureForm.fieldType.$error.required">This field is required!</li>
												<li ng-show="ADTStructureForm.fieldType.$error.adt">{{ADTStructureForm.fieldType.$error.adt}}</li>
											</ul>
										</div>
										<div class="col-sm-1 reset-padding pull-left">
											<button ng-click="deleteStructure(ADTindex,$index)" class="btn  pull-right">X</button>
										</div>
									</div>
								</div>
							</div>
							<div class="form-group">
								<div class="col-sm-12 reset-padding">
									<button ng-click="addStructure(ADTindex)" class="btn btn-mini pull-right">Add Field</button>
								</div>
							</div>
							<div class="form-group col-sm-12">
								<label class=" control-label col-sm-2 reset-padding">Examples:</label>
								<div class="form-group col-sm-10 reset-padding" >
									<div ng-form="ADTExamplesForm" class="form-horizontal form-container" ng-repeat="example in ADT.examples track by $index">
										<div class="col-sm-3 reset-padding">
											<input class="form-control" type="text" ng-model="example.name" name="exampleName"
											placeholder="Example Name" required/>
											<ul class="help-block" ng-show="ADTExamplesForm.exampleName.$dirty && ADTExamplesForm.exampleName.$invalid">
												<li ng-show="ADTExamplesForm.exampleName.$error.required">This field is required!</li>
											</ul>
										</div>
										<div class="col-sm-5 reset-padding">
											<textarea class="form-control" type="text" ng-model="example.value" name="exampleValue"
											placeholder="Insert the value of the example" json-validator="{{ADT.name}}" required press-enter="addStructure(ADTindex)"></textarea>
											<ul class="help-block" ng-show="ADTExamplesForm.exampleValue.$dirty && ADTExamplesForm.exampleValue.$invalid">
												<li ng-show="ADTExamplesForm.exampleValue.$error.required">This field is required!</li>
												<li ng-show="ADTExamplesForm.exampleValue.$error.json" ng-repeat="error in ADTExamplesForm.exampleValue.$error.json">{{error}}</li>
											</ul>
										</div>
										<div class="col-sm-1 reset-padding">
											<button ng-click="deleteExample(ADTindex,$index)" class="btn  pull-right">X</button>
										</div>
									</div>
								</div>
							</div>
							<div class="form-group">
								<div class="col-sm-12 reset-padding">
									<button ng-click="addExample(ADTindex)" class="btn btn-mini pull-right">Add Example</button>
								</div>
							</div>
							<div ng-show="ADTindex!=ADTs.length-1" class="line-separator"></div>
						</div>
						<div class="col-sm-1">
							<button ng-click="deleteADT(ADTindex)" class="btn  pull-right">X</button>
						</div>
					</div>
					<button ng-click="addADT()" class="btn btn-small">Add ADT</button>
				</div>
				
			</div>
			<div class="section section-description">
				<div class="section-title" >
					Functions
				</div>
				<div class="section-content" >
					<span>
					Describe functions with a name, list of parameters, description, and code with surrounding
					function brackets, and if needed some tests.
					<BR>
					</span>
					<div  ng-repeat="(functionIndex,function) in functions"   class="row">
						<div ng-form="functionForm" class="col-sm-10 form-horizontal" role="form">
							<div class="form-group">
								<label for="functionDescription" class="col-sm-2 control-label reset-padding">description</label>
								<div class="col-sm-8 reset-padding">
									<textarea class="form-control" name="functionDescription" placeholder="briefly describe the purpose and the behavior of the function" ng-model="function.description" required ng-pattern="/^[^/\\]+$/" focus></textarea>
									<ul class="help-block" ng-show="functionForm.functionDescription.$dirty && functionForm.functionDescription.$invalid">
										<li ng-show="functionForm.functionDescription.$error.required">This field is required!</li>
										<li ng-show="functionForm.functionDescription.$error.pattern">The "\" and "/" are not allowed</li>
									</ul>
								</div>
								<div class="col-sm-2">
									<span>Description Read Only</span>
									<input type="checkbox" ng-model="function.readOnly">
								</div>
							</div>
							<div class="form-group">
								<label for="returnType" class="col-sm-2 control-label reset-padding">return data type</label>
								<div class="col-sm-10 reset-padding">
									<input type="text" class="form-control" name="returnType" ng-model="function.returnType" adt-validator required placeholder="insert the return data type" press-enter="addParameter()" >
									<ul class="help-block" ng-show="functionForm.returnType.$dirty && functionForm.returnType.$invalid">
										<li ng-show="functionForm.returnType.$error.required">This field is required!</li>
										<li ng-show="functionForm.returnType.$error.adt"> {{functionForm.returnType.$error.adt}}</li>
									</ul>
								</div>
							</div>
							<div class="form-group">
								<label for="functionName" class="col-sm-2 control-label reset-padding">function name</label>
								<div class="col-sm-10 reset-padding">
									<input type="text" class="form-control" name="functionName" ng-model="function.name" required ng-pattern="/^[a-zA-Z0-9_]+$/" placeholder="insert the function name" press-enter="addParameter()">
									<ul class="help-block" ng-show="functionForm.functionName.$dirty && functionForm.functionName.$invalid">
										<li ng-show="functionForm.functionName.$error.required">This field is required!</li>
										<li ng-show="functionForm.functionName.$error.pattern">Is not a valid function name! Please use only alphanumerical characters and the _ symbol</li>
									</ul>
								</div>
							</div>
							<div class="form-group col-sm-12">
								<label class=" control-label col-sm-2 reset-padding">parameters</label>
								<div class="form-group col-sm-10 reset-padding" >
									<div ng-form="param" class="form-horizontal form-container" ng-repeat="name in function.paramNames track by $index ">
										<div class="col-sm-3 reset-padding">
											<input type="text" class="form-control pull-left" ng-model="function.paramNames[$index]" required ng-pattern="/^[a-zA-Z0-9_]+$/" placeholder="name" name="parameterName" unic-name parameters="parameters" press-enter="addParameter()"/>
											<ul class="help-block" ng-show="param.parameterName.$dirty && param.parameterName.$invalid">
												<li ng-show="param.parameterName.$error.required">This field is required!</li>
												<li ng-show="param.parameterName.$error.unic">{{param.parameterName.$error.unic}}</li>
												<li ng-show="param.parameterName.$error.pattern">Is not a valid parameter name!Please use only alphanumerical characters and the _ symbol</li>
											</ul>
										</div>
										<div class="col-sm-3 reset-padding">
											<input type="text" class="form-control pull-left" name="parameterType" ng-model="function.paramTypes[$index]" required adt-validator placeholder="type" press-enter="addParameter()"/>
											<ul class="help-block" ng-show="param.parameterType.$dirty && param.parameterType.$invalid">
												<li ng-show="param.parameterType.$error.required">This field is required!</li>
												<li ng-show="param.parameterType.$error.adt">{{param.parameterType.$error.adt}}</li>
											</ul>
										</div>
										<div class="col-sm-5 reset-padding">
											<input type="text" class="form-control pull-left" name="parameterDescritpion" placeholder="description" ng-model="function.paramDescriptions[$index]" required ng-pattern="/^[a-zA-Z0-9_-\s]+$/" press-enter="addParameter()"/>
											<ul class="help-block" ng-show="param.parameterDescritpion.$dirty && param.parameterDescritpion.$invalid">
												<li ng-show="param.parameterDescritpion.$error.required">This field is required!</li>
												<li ng-show="param.parameterDescritpion.$error.pattern">Please use only alphanumerical characters or - and _ symbols</li>
											</ul>
										</div>
										<div class="col-sm-1 reset-padding">
											<button ng-click="deleteParameter(index)" class="btn  pull-right">X</button>
										</div>
									</div>
								</div>
							</div>
							<div class="form-group">
								<div class="col-sm-12 reset-padding">
									<button ng-click="addParameter(functionIndex)" class="btn btn-mini pull-right">Add Parameter</button>
								</div>
							</div>
							<div class="form-group">
								<label for="code" class="col-sm-2 control-label reset-padding">code</label>
								<div class="col-sm-10 reset-padding">
									<textarea class="form-control" name="code" placeholder="briefly describe the purpose and the behavior of the function" ng-model="function.code"></textarea>
								</div>
							</div>
							<div class="form-group col-sm-12">
								<label class=" control-label col-sm-2 reset-padding">tests:</label>
								<div class="form-group col-sm-10 reset-padding" >
									<div class="col-sm-12 row reset-padding" ng-repeat="tests in function.tests track by $index ">
										<div ng-form="test" class="form-horizontal col-sm-11" >
											<div class="form-group">
												<label for="readOnly" class="col-sm-2 control-label reset-padding">isReadOnly: </label>
												<input name="readOnly" type="checkbox" ng-model="tests.readOnly">
											</div>
											<div  class="form-group">
												<label for="input" class="col-sm-2 control-label reset-padding">Description:</label>
												<div class="col-sm-10 reset-padding">
													<input class="form-control" name="description" ng-model="tests.description" required/>
													<ul class="help-block pull-left" ng-show="test.description.$invalid && test.description.$dirty">
														<li ng-show="test.description.$error.required" >This field is required!</li>
													</ul>
												</div>
											</div>
											<!-- form for each input parameter of the function -->
											<div  class="form-group" ng-form="inputForm" ng-repeat="(index,paramName) in function.paramNames">
												<label for="input" class="col-sm-2 control-label reset-padding"><b>{{paramName}}</b> ({{function.paramTypes[index]}}) </label>
												<div class="col-sm-10 reset-padding">
													<textarea class="form-control" name="input" ng-model="tests.simpleTestInputs[index]" required json-validator="{{function.paramTypes[index]}}"></textarea>
													<ul class="help-block pull-left" ng-show="inputForm.$invalid && inputForm.$dirty">
														<li ng-show="inputForm.input.$error.required" >This field is required!</li>
														<li ng-show="inputForm.input.$error.json" ng-repeat="error in inputForm.input.$error.json">{{error}}</li>
													</ul>
												</div>
											</div>
											<!-- form for the output of the function -->
											<div class="form-group" ng-form="outputForm">
												<label for="input" class="col-sm-2 control-label reset-padding"><b>return value</b> ({{function.returnType}})</label>
												<div class="col-sm-10 reset-padding">
													<textarea class="form-control" name="output" ng-model="tests.simpleTestOutput" required json-validator="{{function.returnType}}" allow-null="true" ></textarea>
													<ul class="help-block pull-left" ng-show="outputForm.$invalid && outputForm.$dirty">
														<li ng-show="outputForm.output.$error.required" >This field is required!</li>
														<li ng-show="outputForm.output.$error.json" ng-repeat="error in outputForm.output.$error.json" >{{error}}</li>
													</ul>
												</div>
											</div>
											<div ng-show="$index!=function.tests.length-1" class="line-separator"></div>
										</div>
										<div class="col-sm-1 reset-padding">
											<button ng-click="deleteTest(functionIndex,$index)" class="btn  pull-right">X</button>
										</div>
									</div>
								</div>
							</div>
							<div class="form-group">
								<div class="col-sm-12 reset-padding">
									<button ng-click="addTest(functionIndex)" class="btn btn-mini pull-right">Add Test</button>
								</div>
							</div>
							<div ng-show="functionIndex!=functions.length-1" class="line-separator"></div>
						</div>
						<div class="col-sm-1">
							<button ng-click="deleteFunction(functionIndex)" class="btn  pull-right">X</button>
						</div>
					</div>
					<button ng-click="addFunction()" class="btn btn-small">Add function</button><BR>
				</div>
			</div>
		</div>
	    <div class="button-bar">
	    	<div class="btn-group pull-left" role="group"  >
	    	  <button type="button" ng-click="submit(form)" tabindex="99" class="btn btn-primary btn-sm">Submit</button>
	    	</div>


	    	<span class="clearfix"></span>
	    </div>
	</body>
</html>