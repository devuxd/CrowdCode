<div  ng-controller="DescribeBehavior">
    
	<div class="header bg-color">
		<span class="type  ">{{::microtask.title}} ({{::microtask.promptType}})</span>
		<span class="reissued" ng-if="microtask.reissuedSubmission !== undefined">REISSUED</span>
		<span class="points">( {{::microtask.points}} pts )</span>
		<button class="btn btn-sm" ng-click="$emit('queue-tutorial', microtask.type, true); ">
			<span class="glyphicon glyphicon-question-sign"></span> 
		</button>
		<span class="clearfix"></span>
    </div>

    <div class="sections">
    	
    	<div class="section bg-color-alpha padding" style="height:5%;">
			
			<span ng-if="microtask.disputedTests === undefined "> 
				Can you describe a behavior for this function?	
			</span>		
			<span ng-if="microtask.disputedTests !== undefined "> 
				Can you fix the issues in the disputed tests?
			</span>			
		</div>

		<div class="section"  style="height:35%;">
			<div class="section-bar">
				<span class="title">
					Function Description
				</span>
				<span class="pull-right">
					<button class="btn btn-sm" ng-click="data.dispute.active = !data.dispute.active;" ng-if="!data.dispute.active">
						Report an issue with the function <span class="glyphicon glyphicon-exclamation-sign"></span>
					</button>
				</span>
				<span class="clearfix"></span>
			</div>
			<div class="section-content padding">
				<js-reader code="funct.getSignature()" ></js-reader>
			</div>					
		</div>


		<div class="section" style="height:200px;" ng-if="data.dispute.active">
			<div class="section-bar">
				<span class="title pull-left">Dispute Function Description</span>
				<span class="pull-right">
					<button class="btn btn-sm" ng-click="data.dispute.active = !data.dispute.active;" >
						Cancel Dispute
					</button>
				</span>
				<span class="clearfix"></span>
			</div>

			<div class="section-content">
				<div class="form" style="height:100%">
					<div class="form-group" style="height:100%">
						<textarea style="height:100%;resize:none;" placeholder="write the reason of the dispute" name="disputeDescription" class="form-control" ng-model="data.dispute.text"></textarea>
					</div>
				</div>
			</div>
		</div>

		<div class="section"  style="height:60%;" ng-if="!data.dispute.active">	
			<div class="section-bar">
				<span class="pull-left title" ng-if="data.selected == -1">
					Described behaviors
				</span>
				<span class="pull-right" ng-if="data.selected == -1">
					<button class="btn btn-sm" ng-click="addNew($event)">
						<span class="glyphicon glyphicon-plus"></span> Add a new test
					</button>
				</span>

				<span class="pull-left" ng-if="data.selected != -1">
					<button class="btn btn-sm" ng-click="toggleSelect($event)">
						<span class="glyphicon glyphicon-arrow-left"></span>
					</button>
				</span>

				<span class="pull-right" ng-if="data.selected != -1">
					<button class="btn btn-sm" ng-click="toggleDelete($event)" ng-if="!data.selected.deleted">
						<span class="glyphicon glyphicon-remove" ></span> Remove test
					</button>

					<button class="btn btn-sm" ng-click="toggleDelete($event)" ng-if="data.selected.deleted">
						<span class="glyphicon glyphicon-remove" ></span> Undo remove
					</button>
				</span>

				<span class="clearfix"></span>
			</div>
			<div class="section-content empty" ng-if="data.tests.length == 0">
				<div>No previous behaviors described!</div>
			</div>

			<div class="section-content padding slide from-left" ng-if="data.tests.length > 0 && data.selected == -1">
				<div class="tests-list">
					<div class="test-item clickable {{ t.dispute.active ? 'disputed' : '' }}" 
					     ng-repeat="t in data.tests track by $index">
						<div ng-click="toggleSelect($event,t)">
							<span class="pull-left">
								<span class="glyphicon glyphicon glyphicon-chevron-right"></span>
								<span ng-if="t.description.length > 0" ng-bind="t.description"></span>
								<span ng-if="!t.description || t.description.length == 0" >missing description</span>
							</span> 
							<span class="pull-right" ng-if="t.deleted">
								<span class="glyphicon glyphicon-remove"  ></span>
								removed
							</span>
							<span class="pull-right" ng-if="!t.deleted && !microtaskForm['testForm_'+$index].$valid">
								<span class="glyphicon glyphicon-exclamation-sign"></span>
								invalid
							</span>
							<span class="clearfix"></span>
						</div>
					</div>
				</div>
			</div>	
			
			<div class="section-content slide from-right padding" 
				 ng-repeat="t in data.tests track by $index" 
				 ng-show="data.selected == t">
				<div ng-form="{{ 'testForm_'+$index }}" class="form form-material" >
					
					<div class="form-group">
						<label for="description">Description </label>
						<input 
							class="form-control" 
							name="description" 
							ng-model="t.description"
							placeholder="insert the description"
							ng-minlength="5"
			           		ng-maxlength="120"
							required
						/>
						<div class="help-block" ng-messages="microtaskForm['testForm_'+$index].description.$error">
							<div ng-if="microtaskForm['testForm_'+$index].description.$dirty">
								<div ng-message="required">the description can't be empty</div>
							    <div ng-message="minlength">the description can't be less than 5 characters</div>
							    <div ng-message="maxlength">the description can't exceed 150 characters</div>
							</div>
						</div>
					</div>
					<div class="form-group">
						<label>Type</label>
						<select class="form-control" ng-model="t.type">
							<option value="simple">simple</option>
							<option value="advanced">advanced</option>
						</select>
					</div>
					<div class="form-group" ng-if="t.type == 'advanced'">
						<label for="code">Code</label>
						<div class="help-icon" >?</div>
						<div class="form-control code" test-editor name="code" ng-model="t.code" required error="testError">
						</div>
						<div class="help-block" ng-messages="microtaskForm['testForm_'+$index].code.$error" >
							<div ng-message="code">{{testError}}</div>
							<div ng-message="required">the test code can't be empty</div>
						</div>
					</div>

					<div class="form-group" ng-if="t.type == 'simple'">
						<label for="code">Input1</label>
						<div class="form-control code" test-editor name="code" ng-model="t.code" error="testError">
						</div>
						<div class="help-block" ng-messages="microtaskForm['testForm_'+$index].code.$error" >
							<div ng-message="code">{{testError}}</div>
						</div>
					</div>

					<div class="form-group" ng-if="t.type == 'simple'">
						<label for="code">Input1</label>
						<div class="form-control code" test-editor name="code" ng-model="t.code" error="testError">
						</div>
						<div class="help-block" ng-messages="microtaskForm['testForm_'+$index].code.$error" >
							<div ng-message="code">{{testError}}</div>
						</div>
					</div>

					<div class="form-group" ng-if="t.type == 'simple'">
						<label for="code">Input1</label>
						<div class="form-control code" test-editor name="code" ng-model="t.code" error="testError">
						</div>
						<div class="help-block" ng-messages="microtaskForm['testForm_'+$index].code.$error" >
							<div ng-message="code">{{testError}}</div>
						</div>
					</div>
				</div>
			</div>	



				

		</div>
<!--
		<div class="section"  style="height:30%;" ng-if="!data.dispute.active">	
			<div class="section-bar">
				<span class="title" ng-if="!data.isComplete">
					Describe a new behavior
				</span>
				<span class="pull-right" ng-if="data.tests.length > 0">
					<input type="checkbox" ng-model="data.isComplete" ng-click="t.editing = !t.editing"> 
				the function is completely described by the previous behaviors
				</span>
				<span class="clearfix"></span>
			</div>
			<div class="section-content" ng-if="!data.isComplete" ng-init="t = data.newTest" >
				<test-editor test="t" tested-function="funct"></test-editor>
			</div>	

			<div class="section-content empty" ng-if="data.isComplete">
			</div>				
		</div>
	</div>
-->
</div>
